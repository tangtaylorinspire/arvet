!function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findObjEvt=function(e,t,i,n){e.preventDefault();var o=getComputedStyle(e.target),r=o.getPropertyValue("transform"),a=o.getPropertyValue("transform-origin").replace(/px/g,"").split(" ");a[0]=parseFloat(a[0]),a[1]=parseFloat(a[1]),a[2]=parseFloat(a[2]||0);var d=new THREE.Matrix4;if(d.identity(),/^matrix\(/.test(r)){var l=r.replace(/^matrix\(|\)$/g,"").split(" ");d.elements[0]=parseFloat(l[0]),d.elements[1]=parseFloat(l[1]),d.elements[4]=parseFloat(l[2]),d.elements[5]=parseFloat(l[3]),d.elements[12]=parseFloat(l[4]),d.elements[13]=parseFloat(l[5])}else if(/^matrix3d\(/i.test(r))for(var l=r.replace(/^matrix3d\(|\)$/gi,"").split(" "),s=0;s<16;s++)d.elements[s]=parseFloat(l[s]);var c=new THREE.Matrix4;c.makeTranslation(a[0],a[1],a[2]),c.multiply(d),d.makeTranslation(-a[0],-a[1],-a[2]),c.multiply(d);var v=new THREE.Vector3(e.layerX,e.layerY,0);v.applyMatrix4(c);var u=parseFloat(o.getPropertyValue("width")),m=parseFloat(o.getPropertyValue("height")),p=new THREE.Vector3(v.x/u*2-1,-v.y/m*2+1,.5);p.unproject(t),p.sub(t.position),p.normalize();var h=new THREE.Raycaster(t.position,p);if(0==n){var g=h.intersectObject(i);console.log(i)}else if(1==n){var g=h.intersectObjects(i.children,!0);console.log(i)}if(g.length>0){var f=g;return f}}},function(e,t,i){"use strict";var n=i(0);function o(e,t,i){t.setPatternDetectionMode(artoolkit.AR_TEMPLATE_MATCHING_MONO_AND_MATRIX);var o=new THREE.PointLight(16777215);e.scene.add(o);var a=new THREE.Scene;(new THREE.OBJLoader2).load("./model/1kidney_VLP.OBJ",function(e){e.rotation.set(-Math.PI/2,-Math.PI/2e3,Math.PI),e.scale.set(.03,.03,.03),e.position.set(1,-6,0),a.add(e)}),document.body.className=t.orientation;var d=new THREE.WebGLRenderer({antialias:!0}),l=Math.min(window.innerWidth/e.video.videoWidth,window.innerHeight/e.video.videoHeight),s=e.video.videoWidth,c=e.video.videoHeight;s=window.innerWidth,c=window.innerHeight,"portrait"===t.orientation?(d.setSize(c,s),d.domElement.style.transformOrigin="0 0 0 0",d.domElement.style.transform="rotate(-90deg) translateX(-100%) scaleX(-1) scaleY(-1);"):/Android|mobile|iPad|iPhone/i.test(navigator.userAgent)?d.setSize(window.innerWidth,window.innerWidth/t.videoWidth*t.videoHeight):(r(s,c,e,d),document.body.className+=" desktop"),document.body.insertBefore(d.domElement,document.body.firstChild),window.addEventListener("resize",function(){var t=window.innerWidth,i=window.innerHeight;console.log("height: "+i+" ,wight: "+t),console.log("Video: height: "+e.video.videoHeight+" ,wight: "+e.video.videoWidth),r(t,i,e,d),document.body.className+=" desktop"}),t.loadMarker("Data/patt.peeBoyBlack",function(i){var n=t.createThreeMarker(i);n.add(a),e.scene.add(n)});d.domElement.addEventListener("click",function(t){(0,n.findObjEvt)(t,e.camera,a,1)&&function(){/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i.test(navigator.userAgent)&&(document.getElementById("overlay").style.width="100%");document.getElementById("overlay").style.opacity=1,document.getElementById("overlay").style.right=0,document.getElementById("overlay").style.transition="opacity 1s, right 1s"}()},!1);!function t(){e.process(),console.log(e),requestAnimationFrame(t),e.renderOn(d)}()}function r(e,t,i,n){var o=t/i.video.videoHeight,r=e/i.video.videoWidth;t>=e?n.setSize(i.video.videoWidth*o,t):e>=t&&(r*i.video.videoHeight<t?n.setSize(i.video.videoWidth*o,t):n.setSize(e,r*i.video.videoHeight))}window.ARThreeOnLoad=function(){navigator.mediaDevices.enumerateDevices().then(function(e){var t=e.find(function(e){return-1!==e.label.indexOf("back")});!function(e){ARController.getUserMediaThreeScene({maxARVideoSize:640,cameraParam:"Data/camera_para-iPhone 6 Plus rear 1280x720 1.0m.dat",deviceId:e.deviceId,facing:"environment",onSuccess:o})}({deviceId:t?{exact:t.deviceId}:void 0})}).catch(function(e){alert(e.name+": "+e.message)})},window.ARController&&ARController.getUserMediaThreeScene&&ARThreeOnLoad()}]);